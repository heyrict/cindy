{% extends 'frames/base.html' %} 
{% load i18n decodes %}

{% block title %} Cindy - mondai {% endblock %} 

{% block content %} 

<h2 id="trans-all-soups" style="border-bottom:1px solid #ccc;">{% trans 'All Soups' %}</h2>

{% for mondai in unsolved_mondai_list %}
<ul>
<li>
    {% if mondai.status == 0 %}
        <span class="status_label status_unsolved"><font color="#cb4b16">unsolved</font></span>
    {% elif mondai.status == 1 %}
        <span class="status_label status_solved"><font color="#859900">solved</font></span>
    {% elif mondai.status == 2 %}
        <span class="status_label status_dazed"><font color="#259185">dazed</font></span>
    {% else %}
        <span class="status_label status_hidden"><font color="gray">hidden</font></span>
    {% endif %}
    
    {% with quescount=mondai.shitumon_set|get_quescount %}
        {% if quescount.unanswered %}
        <span class="process_label unanswered" style="margin-left:5px;">{{ quescount.unanswered }}<sub>{{ quescount.ques }}</sub></span>
        {% else %}
        <span class="process_label answered" style="margin-left:5px;">{{ quescount.unanswered }}<sub>{{ quescount.ques }}</sub></span>
        {% endif %}
    {% endwith %}

    <span class="title_label">
        <a href="{% url 'sui_hei:mondai_show' mondai.id %}">
            [{{ mondai.genre|mondai_genre }}{% if mondai.yami %} &times; {% trans 'yami' %}{% endif %}]
            {{ mondai.title }}
        </a>
    </span>

    {% if mondai.score > 50 or mondai.user_id == user and mondai.star_set.count > 0 %}
    <span class="mondai_score">
        {{ mondai.score|normalize_star }}✯{{ mondai.star_set.count }}
    </span>
    {% endif %}

    {% with mondai_user=mondai.user_id %}
    <span style="float:right; text-decoration:bold;">
        <a href="{% url 'sui_hei:profile' mondai_user.id %}" class="bul">{{ mondai_user.nickname }}</a>
        {% if mondai_user.current_award %}[{{ mondai_user.current_award }}]{% endif %}
        <font color="#888">[{% trans 'created' %}: {{ mondai.created }}]</font>
    </span>
    {% endwith %}
    <div class="clear"></div>
</li>
</ul>
{% endfor %}

<div align="center" style="border-top:1px solid #ccc;"><br /></div>

{% include 'frames/pagination.html' with ln_prefix='?page=' %}

{% for mondai in mondai_list %}
<ul>
<li>
    {% if mondai.status == 0 %}
        <span class="status_label status_unsolved"><font color="#cb4b16">unsolved</font></span>
    {% elif mondai.status == 1 %}
        <span class="status_label status_solved"><font color="#859900">solved</font></span>
    {% elif mondai.status == 2 %}
        <span class="status_label status_dazed"><font color="#259185">dazed</font></span>
    {% else %}
        <span class="status_label status_hidden"><font color="gray">hidden</font></span>
    {% endif %}
    
    {% with quescount=mondai.shitumon_set|get_quescount %}
        {% if quescount.unanswered %}
        <span class="process_label unanswered" style="margin-left:5px;">{{ quescount.unanswered }}<sub>{{ quescount.ques }}</sub></span>
        {% else %}
        <span class="process_label answered" style="margin-left:5px;">{{ quescount.unanswered }}<sub>{{ quescount.ques }}</sub></span>
        {% endif %}
    {% endwith %}

    <span class="title_label">
        <a href="{% url 'sui_hei:mondai_show' mondai.id %}">
            [{{ mondai.genre|mondai_genre }}{% if mondai.yami %} × {% trans 'yami' %}{% endif %}]
            {{ mondai.title }}
        </a>
    </span>

    {% if mondai.score > 0 or mondai.user_id == user and mondai.star_set.count > 0 %}
    <span class="mondai_score">
        {{ mondai.score|normalize_star }}✯{{ mondai.star_set.count }}
    </span>
    {% endif %}

    {% with mondai_user=mondai.user_id %}
    <span style="float:right; text-decoration:bold;">
        <a href="{% url 'sui_hei:profile' mondai_user.id %}" class="bul">{{ mondai_user.nickname }}</a>
        {% if mondai_user.current_award %}[{{ mondai_user.current_award }}]{% endif %}
        <font color="#888">[{% trans 'created' %}: {{ mondai.created }}]</font>
    </span>
    {% endwith %}
    <div class="clear"></div>
</li>
</ul>
{% endfor %}

{% endblock %} 
