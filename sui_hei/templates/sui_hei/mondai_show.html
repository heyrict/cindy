{% extends 'frames/base.html' %} 
{% load i18n static markdown decodes %}

{% block title %} Cindy - mondai - show {% endblock %} 

{% block pageTitle %}
[{{ mondai.genre|mondai_genre }}{% if mondai.yami %} × {% trans 'yami' %}{% endif %}] {{ mondai.title }}
{% endblock %}

{% block script_include %}
<link rel="stylesheet" href="{% static 'css/mondai_show.css' %}">
<script src="{% static 'js/dist/mondai_show.js' %}"></script>
{% endblock %}

{% block extra_header %}
{% if mondai.memo %}
<div class="memobar rightbar" mode={{ mode|default:"closed" }} >
    <img class="memobar_button rightbar_button" src={% static 'pictures/memobar.png' %}>
    <div class="memobar_content rightbar_content">
        <div style="margin-right:15px;">
        {{ mondai.memo|text2md|safe }}
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block content %} 
<div id="default_channel" class="hidden" value="mondai-{{ mondai.id }}"></div>
<h2>
    [{{ mondai.genre|mondai_genre }}{% if mondai.yami %} × {% trans 'yami' %}{% endif %}] {{ mondai.title }}
    {% if mondai.status >= 2 %}
    <font color=gray>({{ mondai.status|mondai_status }})</font>
    {% endif %}
</h2>

<!-- Content of Question -->
<div class="mondai_content well" style="background:inherit">
    <div class="mondai_content_header">
    </div>
    <div class="mondai_content_content">
    </div>
    <br />
    <div class="mondai_content_comments">
    </div>
</div>
<!-- End Content of Question -->
<br>
<!-- Q&A -->
{% if user == mondai.user_id %}
<form id="mondai_show_push_answ" action="{% url 'sui_hei:mondai_show_push_answ' %}" method="post">
{% csrf_token %}
{% endif %}

<div class="mondai_qna"></div>

{% if user == mondai.user_id %}
<input value={% trans 'Put Responds' %} type="submit">
{% endif %}
</form>
<!-- End Q&A -->
<br>
<!-- Answer of Question -->
{% if mondai.status == 1 or mondai.status == 2 or mondai.user_id == user %} <!-- Solved or Dazed -->
<div class="mondai_kaisetu well" style="background:inherit;">
    <div class="mondai_kaisetu_content">
        {{ mondai.kaisetu|text2md|safe }}
    </div>
    {% if user.is_authenticated and mondai.user_id != user %}
    <br>
    <div align="center"><div class="hline"></div></div>
    <!-- Evaluation Panel -->
    <div id="mondai_star_form">
      <input id="starbar" data-slider-id='starbar_slider' type="text" data-slider-min="0" data-slider-max="100"
        data-slider-step=".1" data-slider-value="{{ mystar|default:"0" }}" data-slider-handle="custom" />
      <input id="starbutton" type="submit" value="{% trans 'Star' %}" style="font-size: 17px;">
    </div>
    <div class="clear"></div>
    {% if mycomment %}
    {% else %}
    <div class="paticipants_panel" id="evaluation_panel">
        <input id="comment_input" name="push_chat" type="text" style="width:78%;" 
            placeholder="{% trans 'Comment here to introduce this Question to others!' %}">
        <input id="comment_submit" value="{% trans 'Add Comments' %}" type="submit" style="width:20%; font-size: 17px;">
    </div>
    {% endif %}
    <br>
    <!-- Evaluation Panel -->
    {% endif %}
</div>
{% endif %}

{% if user == mondai.user_id and mondai.status >= 1 and mondai.status <= 3 %} <!-- Display giver panel if solved-->
<!-- giver panel -->
<form class="well" action="{% url 'sui_hei:mondai_show_update_soup' %}" method="post">
    {% csrf_token %}
    <span class="giver_panel">
        <div>{% trans 'Memo' %}: 
        <textarea id="memo_textarea" name="change_memo">{{ mondai.memo }}</textarea></div>

        <input type="checkbox" name="toggle_yami">
        {% if mondai.yami %}{% trans 'uncheck as yami' %}{% else %}{% trans 'check as yami' %}{% endif %}<br>

        {% if mondai.status <= 3 %}
        <input type="checkbox" name="toggle_status_hidden">
        {% if mondai.status == 3 %}{% trans 'uncheck as hidden' %}{% else %}{% trans 'check as hidden' %}{% endif %}<br>
        {% endif %}
        <input value="{% trans 'Update' %}" type="submit">
    </span>
</form><br>
<!-- end giver panel -->
{% elif mondai.status == 0 %}
    {% if not user.is_authenticated %}
    <!-- for guests -->
    <a href="{% url "sui_hei:login" %}">{% trans 'Hello guest! I need to know who you are before you ask a question!' %}</a>
    <!-- end for guests -->
    {% elif user == mondai.user_id %}
    <!-- giver panel -->
    <form action="{% url 'sui_hei:mondai_show_update_soup' %}" method="post">
        {% csrf_token %}
        <span class="giver_panel">
            <div style="float:left; width:44%;">{% trans 'Memo' %}: 
            <textarea id="memo_textarea" name="change_memo">{{ mondai.memo }}</textarea></div>

            <div style="float:right; width:55%;">{% trans 'True Answer' %}: 
            <textarea id="kaisetu_textarea" name="change_kaisetu">{{ mondai.kaisetu }}</textarea></div>

            <div class="clear"></div>

            <input type="checkbox" name="toggle_yami">
            {% if mondai.yami %}{% trans 'uncheck as yami' %}{% else %}{% trans 'check as yami' %}{% endif %}<br>
            <input type="checkbox" name="change_seikai" id="change_seikai_ckbx">
            {% trans 'Put True Answer' %}<br>
            <input value="{% trans 'Update' %}" type="submit">
        </span>
    </form><br>
    <div class="well" style="border:3px solid #728905;">
        <font color=#52676f" size="5px" face="monospace">{% trans 'True Answer' %} {% trans 'Preview' %}</font>
        <div id="kaisetu_preview"></div>
    </div>
    <!-- end giver panel -->
    {% else %}
    <!-- paticipants panel -->
    <form id="mondai_show_push_ques" action="{% url 'sui_hei:mondai_show_push_ques' %}" method="post">
        {% csrf_token %}
        <span class="paticipants_panel">
            <input id="ques_input" name="push_ques" type="text">
            <input value="{% trans 'Put Question' %}" type="submit">
        </span>
    </form>
    <!-- end paticipants panel -->
    {% endif %}
{% endif %}
<!-- End Answer of Question -->

{% endblock %} 
