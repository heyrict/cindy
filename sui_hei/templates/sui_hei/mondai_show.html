{% extends 'frames/base.html' %} 
{% load i18n static markdown decodes %}

{% block title %} Cindy - mondai - show {% endblock %} 

{% block style %}
    .clear {
        clear: both
    }
    .HBar {
    }
    .QBlock {
        float: left;
        width: 48%;
        border: 1px solid #268bd288;
        border-radius: 5px;
        padding: 3px;
        font-size: 16px;
    }
    .ABlock {
        float: right;
        width: 48%;
        border: 1px solid #268bd288;
        border-radius: 5px;
        padding: 3px;
        font-size: 16px;
    }
{% endblock %}

{% block content %} 
<h2>{{ mondai.title }} [{{ mondai.genre|genre }}]</h2>

<!-- Content of Question -->
<div class="mondai_content wrapper">
    <ul style="left: 10px;">
        <li>{% trans "Giver" %}: {{ mondai.user_id.nickname }}</li>
        <li>{% trans "Give time" %}: {{ mondai.created }}</li>
    </ul>
    {{ mondai.content|text2md|safe }}
</div>
<!-- End Content of Question -->
<br>
<!-- Q&A -->
{% if user == mondai.user_id %}
<form action="{% url 'sui_hei:mondai_show_push_answ' %}" method="post">
{% csrf_token %}
{% endif %}
<div class="mondai_qna">
    {% for qna in qnas %}
    <div class="HBar">
        <div class="QBlock">
            <div style="width:29%; float:left; border-right: 1px solid #268bd288;">
                    <a href={% url 'sui_hei:profile' qna.user_id.id %}>{{ qna.user_id.nickname }}</a>
            </div>
            <div style="width:69%; float:right;">
                {{ qna.shitumon|line2md|safe }}
                {% if qna.user_id == user %}
                <a href="/mondai/edit/Shitumon/shitumon/{{ qna.id }}">{% trans '[edit]' %}</a>
                {% endif %}
            </div>
        </div>
        <div class="ABlock">
            {% if user == mondai.user_id %}
            <!-- for giver -->
                {% if qna.kaitou %}
                <div>
                <div style="width:69.2%; float:left; border-right: 1px solid #268bd288;">
                    {% if qna.true %}<font size="7" color="#dc322f">&#9996;</font>{% endif %}
                    {% if qna.good %}<font size="7" color="#b58900">&#128077;</font>{% endif %}
                    {{ qna.kaitou|line2md|safe }} 
                    <a href="/mondai/edit/Shitumon/kaitou/{{ qna.id }}">{% trans '[edit]' %}</a>
                </div>
                <div style="width:30.2%; float:right;">
                    <a href={% url 'sui_hei:profile' mondai.user_id.id %}>{{ mondai.user_id.nickname }}</a>
                </div>
                {% else %}
                <input id="answ_input" name="push_answ_{{ qna.id }}" type="text">
                {% endif %}
                </div>
                <div class="clear"></div>
                <div style="border-top: 1px solid #268bd288">
                <input type="checkbox" name="check_goodques_{{ qna.id }}">
                {% if qna.good %}
                    {% trans 'uncheck as good-question' %}
                {% else %}
                    {% trans 'check as good-question' %}
                {% endif %}<br>
                <input type="checkbox" name="check_trueansw_{{ qna.id }}">
                {% if qna.true %}
                    {% trans 'uncheck as true-answer' %}
                {% else %}
                    {% trans 'check as true-answer' %}
                {% endif %}</div>
            <!-- end for giver -->
            {% else %}
            <!-- for others -->
                {% if qna.kaitou %} 
                <div style="width:69%; float:left; border-right: 1px solid #268bd288">
                    {% if qna.true %}<font size="7" color="#dc322f">&#9996;</font>{% endif %}
                    {% if qna.good %}<font size="7" color="#b58900">&#128077;</font>{% endif %}
                    {{ qna.kaitou|line2md|safe }} 
                </div>
                <div style="width:29%; float:right;">
                    <a href={% url 'sui_hei:profile' mondai.user_id.id %}>{{ mondai.user_id.nickname }}</a>
                </div>
                {% else %} <span style="color:#93a1a1">{% trans 'waiting to be answered' %}</span>
                {% endif %}
            <!-- end for others -->
            {% endif %}
        </div>
        <div class="clear"></div>
    </div>
    {% endfor %}
</div>
{% if user == mondai.user_id %}
<input value={% trans 'Put Responds' %} type="submit">
{% endif %}
</form>
<!-- End Q&A -->
<br>
<!-- Answer of Question -->
{% if mondai.seikai %}
<div class="mondai_kaisetu wrapper">
    <h3 id="true-answer">{% trans "True Answer" %}</h3>
    {{ mondai.kaisetu|text2md|safe }}
</div>
{% else %}
    {% if not user.is_authenticated %}
    <!-- for guests -->
    You are a guest!
    <!-- end for guests -->
    {% elif user == mondai.user_id %}
    <!-- giver panel -->
    <form action="{% url 'sui_hei:mondai_show_update_soup' %}?mondai={{ mondai.id }}" method="post">
        {% csrf_token %}
        <span class="giver_panel">
            <p>{% trans 'True Answer' %}: 
            <textarea id="kaisetu_textarea" name="change_kaisetu">{{ mondai.kaisetu }}</textarea></p>
            <input type="checkbox" name="change_seikai" onclick="alert('You cannot revert change if you put the true answer!')">
            {% trans 'Put True Answer' %}<br>
            <input value="Update" type="submit">
        </span>
    </form>
    <!-- end giver panel -->
    {% else %}
    <!-- paticipants panel -->
    <form action="{% url 'sui_hei:mondai_show_push_ques' %}?mondai={{ mondai.id }}" method="post">
        {% csrf_token %}
        <span class="paticipants_panel">
            <input id="ques_input" name="push_ques" type="text">
            <input value="Put Question" type="submit">
        </span>
    </form>
    <!-- end paticipants panel -->
    {% endif %}
{% endif %}
<!-- End Answer of Question -->

{% endblock %} 
